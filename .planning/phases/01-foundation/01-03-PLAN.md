---
phase: 01-foundation
plan: 03
type: execute
wave: 3
depends_on: ['01-02']
files_modified:
    - studio/structure/index.ts
    - studio/sanity.config.ts
autonomous: false

must_haves:
    truths:
        - 'Studio sidebar shows grouped navigation: Content (Posts, Gems), Taxonomies (Tags,
          Series), Settings (Authors)'
        - 'Posts list shows filter tabs for All/Drafts/Published/Hidden'
        - 'Posts are sorted newest first by default'
        - 'Studio deploys to maxdaten.sanity.studio successfully'
        - 'Draft/published status visible in document list'
    artifacts:
        - path: 'studio/structure/index.ts'
          provides: 'Sidebar structure configuration'
          exports: ['structure']
        - path: 'studio/sanity.config.ts'
          provides: 'Studio config with structure plugin'
          contains: 'structureTool'
    key_links:
        - from: 'studio/sanity.config.ts'
          to: 'studio/structure/index.ts'
          via: 'structure option in structureTool'
          pattern: 'structureTool.*structure'
---

<objective>
Configure Studio sidebar organization with grouped navigation and deploy to Sanity's hosted service.

Purpose: Provides organized authoring experience with logical grouping and enables remote access to
Studio. Output: Deployed Studio at maxdaten.sanity.studio with organized sidebar. </objective>

<execution_context> @./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md </execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure Studio sidebar structure</name>
  <files>
    studio/structure/index.ts
    studio/sanity.config.ts
  </files>
  <action>
Create sidebar structure per CONTEXT.md Studio Organization decisions and RESEARCH.md Pattern 6.

**Structure Configuration (studio/structure/index.ts):**

Create structure builder configuration:

```typescript
import { StructureBuilder } from 'sanity/structure';

export const structure = (S: StructureBuilder) =>
    S.list()
        .title('Content')
        .items([
            // Content group
            S.listItem()
                .title('Content')
                .child(
                    S.list()
                        .title('Content')
                        .items([
                            // Posts with filter views
                            S.listItem()
                                .title('Posts')
                                .child(
                                    S.list()
                                        .title('Posts')
                                        .items([
                                            S.listItem()
                                                .title('All Posts')
                                                .child(
                                                    S.documentTypeList('post')
                                                        .title('All Posts')
                                                        .defaultOrdering([
                                                            { field: 'date', direction: 'desc' },
                                                        ])
                                                ),
                                            S.listItem()
                                                .title('Drafts')
                                                .child(
                                                    S.documentList()
                                                        .title('Draft Posts')
                                                        .filter(
                                                            '_type == "post" && _id in path("drafts.**")'
                                                        )
                                                        .defaultOrdering([
                                                            { field: 'date', direction: 'desc' },
                                                        ])
                                                ),
                                            S.listItem()
                                                .title('Published')
                                                .child(
                                                    S.documentList()
                                                        .title('Published Posts')
                                                        .filter(
                                                            '_type == "post" && !(_id in path("drafts.**"))'
                                                        )
                                                        .defaultOrdering([
                                                            { field: 'date', direction: 'desc' },
                                                        ])
                                                ),
                                            S.listItem()
                                                .title('Hidden')
                                                .child(
                                                    S.documentList()
                                                        .title('Hidden Posts')
                                                        .filter('_type == "post" && hidden == true')
                                                        .defaultOrdering([
                                                            { field: 'date', direction: 'desc' },
                                                        ])
                                                ),
                                        ])
                                ),
                            S.documentTypeListItem('gem').title('Gems'),
                        ])
                ),
            S.divider(),
            // Taxonomies group
            S.listItem()
                .title('Taxonomies')
                .child(
                    S.list()
                        .title('Taxonomies')
                        .items([
                            S.documentTypeListItem('tag').title('Tags'),
                            S.documentTypeListItem('series').title('Series'),
                        ])
                ),
            S.divider(),
            // Settings group
            S.listItem()
                .title('Settings')
                .child(
                    S.list()
                        .title('Settings')
                        .items([S.documentTypeListItem('author').title('Authors')])
                ),
        ]);
```

**Update sanity.config.ts:**

Import structure from './structure' and pass to structureTool:

```typescript
import { structureTool } from 'sanity/structure';
import { structure } from './structure';

export default defineConfig({
    // ...existing config...
    plugins: [structureTool({ structure }), visionTool()],
});
```

This creates sidebar with:

- Content > Posts (All/Drafts/Published/Hidden), Gems
- Taxonomies > Tags, Series
- Settings > Authors

Posts are sorted newest first (date desc) by default. </action> <verify> cd
/Users/jloos/Developer/maxdaten-io/maxdaten.io/studio && npm run dev Start Studio locally, verify
sidebar shows grouped structure with Content, Taxonomies, Settings sections. Navigate to Content >
Posts, verify All/Drafts/Published/Hidden filter tabs appear. </verify> <done> Sidebar shows grouped
navigation. Posts have filter views. Default ordering is newest first. </done> </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Sanity Studio with:
- All document schemas (post, gem, tag, author, series)
- Portable Text with custom blocks (code, callout, image, embed)
- Organized sidebar with Content/Taxonomies/Settings groups
- Posts filter views (All/Drafts/Published/Hidden)
- Global slug uniqueness validation
  </what-built>
  <how-to-verify>
1. Start Studio: `cd studio && npm run dev`
2. Open http://localhost:3333
3. Verify sidebar structure:
   - Content section with Posts and Gems
   - Posts sub-menu with All/Drafts/Published/Hidden views
   - Taxonomies section with Tags and Series
   - Settings section with Authors
4. Create test content:
   - Create an author (your info)
   - Create a tag (e.g., "test")
   - Create a blog post with:
     - Title, auto-generated slug
     - Body with paragraph, code block (select language, add filename)
     - Body with callout (select type)
     - Cover image with hotspot crop
     - Select the tag you created
5. Verify the post appears in "All Posts" view sorted by date
6. Edit the post without publishing - verify it appears in "Drafts" view
7. Create a gem with manual slug entry
8. Try creating another gem with same slug - should fail validation

Type "approved" if Studio works correctly, or describe any issues. </how-to-verify>
<resume-signal>Type "approved" or describe issues</resume-signal> </task>

<task type="auto">
  <name>Task 2: Deploy Studio to Sanity hosted service</name>
  <files>
    studio/sanity.cli.ts
  </files>
  <action>
Deploy the Studio to Sanity's hosted service.

1. Ensure SANITY_STUDIO_PROJECT_ID env var is set (from user setup)
2. Verify sanity.cli.ts has studioHost: 'maxdaten'
3. Run `cd studio && npm run deploy`
4. The CLI will:
    - Build the Studio
    - Upload to Sanity's hosting
    - Deploy to https://maxdaten.sanity.studio

If the studioHost is already taken, the deploy will fail with an error. In that case:

- Choose an alternative: 'maxdaten-io' or 'maxdaten-blog'
- Update sanity.cli.ts with the new studioHost
- Re-run deploy

Note: First-time deploy may prompt for Sanity login via CLI. Run `npx sanity login` first if needed.
</action> <verify> curl -I https://maxdaten.sanity.studio 2>/dev/null | head -5 Should return HTTP
200 or redirect to the deployed Studio. </verify> <done> Studio deployed and accessible at
https://maxdaten.sanity.studio (or alternative hostname if maxdaten was taken). </done> </task>

</tasks>

<verification>
1. Local Studio: `cd studio && npm run dev` starts without errors
2. Sidebar: Shows Content > Posts (with filters) > Gems, Taxonomies > Tags > Series, Settings > Authors
3. Posts ordering: Newest first by date
4. Filter views: All/Drafts/Published/Hidden show correct filtered lists
5. Deployment: https://maxdaten.sanity.studio loads the Studio
6. Remote access: Can log in and see same schemas as local
</verification>

<success_criteria>

- Sidebar organized into Content, Taxonomies, Settings groups
- Posts have All/Drafts/Published/Hidden filter views
- Posts default sorted newest first
- Studio deployed to \*.sanity.studio
- Deployed Studio accessible and functional
- Draft/publish workflow visible (documents show draft state) </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
