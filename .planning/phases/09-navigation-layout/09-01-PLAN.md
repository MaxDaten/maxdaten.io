---
phase: 09-navigation-layout
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
    - src/lib/components/organisms/Header.svelte
autonomous: true

must_haves:
    truths:
        - 'Navigation shows orange underline on current page section'
        - 'Navigation links have 44px minimum tap target on mobile'
        - 'Hover state uses color/opacity, not underline'
    artifacts:
        - path: 'src/lib/components/organisms/Header.svelte'
          provides: 'Active state + tap target navigation'
          contains: 'page.url.pathname'
    key_links:
        - from: 'Header.svelte'
          to: '$app/state'
          via: 'page import'
          pattern: "import.*page.*from.*\\$app/state"
---

<objective>
Add active page indicator and mobile tap targets to navigation.

Purpose: Users can see which section they're in. Mobile users have comfortable touch targets.
Output: Navigation with orange underline on active section, 44px tap targets on mobile. </objective>

<execution_context> @./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md </execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-navigation-layout/09-CONTEXT.md
@.planning/phases/09-navigation-layout/09-RESEARCH.md
@src/lib/components/organisms/Header.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add active state with page detection</name>
  <files>src/lib/components/organisms/Header.svelte</files>
  <action>
Import `page` from `$app/state` (NOT `$app/stores`).

Add `isActive` function that matches current pathname to nav href:

- Exact match for `/blog` and `/gems`
- Section match using `startsWith(href + '/')` for nested routes like `/blog/my-post`

Apply `.active` class using `class:active={isActive('/blog')}` pattern. Add `aria-current="page"`
when active for accessibility.

Style active state:

- Use `::after` pseudo-element for underline
- Position: absolute, bottom: 4px (close to text)
- Height: 2px (thin underline)
- Background: var(--color--primary)

Modify hover state to NOT conflict:

- Keep existing hover color/drop-shadow
- Add `:not(.active)` selector so hover doesn't apply to active link </action> <verify> Run
  `npm run check` - no TypeScript errors. Run `npm run dev` and navigate to /blog - Blog link shows
  orange underline. Navigate to /gems - Gems link shows orange underline, Blog link loses underline.
  Navigate to a blog post - Blog link still shows underline (section match). </verify> <done> Active
  link shows orange underline. Hover on non-active links shows color/glow. aria-current="page"
  present on active link. </done> </task>

<task type="auto">
  <name>Task 2: Increase mobile tap targets</name>
  <files>src/lib/components/organisms/Header.svelte</files>
  <action>
Inside `.links a` styles, add mobile-specific tap target sizing:

```scss
@include breakpoints.for-phone-only {
    min-height: 44px;
    display: flex;
    align-items: center;
}
```

This ensures 44px touch target (Apple HIG guideline) while keeping desktop compact.

Also add vertical padding to all screen sizes for consistent clickable area:

```scss
.links a {
    padding: 8px 0;
    // ... existing styles
}
```

  </action>
  <verify>
Run `npm run dev` and use browser DevTools mobile emulation.
Inspect nav links - verify min-height: 44px applied on mobile viewport.
Test tapping links - should be easy to tap without precision.
  </verify>
  <done>
Navigation links have 44px minimum height on mobile. Desktop remains compact.
  </done>
</task>

</tasks>

<verification>
Visual verification:
1. Desktop: Active link has thin orange underline, non-active links show hover glow
2. Mobile: Links easy to tap, active state visible
3. Navigation to nested routes (e.g., /blog/post-slug) keeps parent section active

Code verification:

- `npm run check` passes
- `npm run lint` passes </verification>

<success_criteria>

- [ ] Active page shows orange underline indicator
- [ ] Hover uses color/glow on non-active links only
- [ ] Mobile tap targets are 44px minimum height
- [ ] aria-current="page" on active links
- [ ] No TypeScript or lint errors </success_criteria>

<output>
After completion, create `.planning/phases/09-navigation-layout/09-01-SUMMARY.md`
</output>
