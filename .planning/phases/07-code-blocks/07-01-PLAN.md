---
phase: 07-code-blocks
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
    - src/lib/scss/_markdown.scss
    - src/lib/components/molecules/CodeBlock.svelte
autonomous: true

must_haves:
    truths:
        - 'Code blocks display with near-black background (#1a1a1a) regardless of page theme'
        - 'Code block containers have 12px rounded corners'
        - 'Code on mobile devices displays at readable 12px font size (not 10px)'
    artifacts:
        - path: 'src/lib/scss/_markdown.scss'
          provides: 'Updated pre.shiki styles with dark background, 12px radius, 12px mobile font'
          contains: '#1a1a1a'
        - path: 'src/lib/components/molecules/CodeBlock.svelte'
          provides: 'Coordinated border-radius on figure container'
          contains: 'border-radius: 12px'
    key_links:
        - from: 'src/lib/components/molecules/CodeBlock.svelte'
          to: 'src/lib/scss/_markdown.scss'
          via: 'pre.shiki inside figure'
          pattern: 'figcaption.*pre\\.shiki|border.*radius'
---

<objective>
Update code block container styling for modern appearance: dark background independent of theme, 12px border-radius, and readable mobile font size.

Purpose: Create visually consistent, professional code blocks that maintain readability across all
devices and potential future theme modes. Output: Updated SCSS with dark background, 12px radius,
and 12px mobile font size. Coordinated border-radius on wrapper component. </objective>

<execution_context> @./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md </execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-code-blocks/07-CONTEXT.md
@.planning/phases/07-code-blocks/07-RESEARCH.md
@src/lib/scss/_markdown.scss
@src/lib/components/molecules/CodeBlock.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update pre.shiki base styles</name>
  <files>src/lib/scss/_markdown.scss</files>
  <action>
Update the `pre.shiki` styles in _markdown.scss:

1. Add explicit dark background that won't change with theme:
    - `background-color: #1a1a1a;` (near-black, theme-independent)

2. Update border-radius from 8px to 12px:
    - `border-radius: 12px;`

3. Update mobile font size from 10px to 12px:
    - In the `@include breakpoints.for-phone-only` block, change `font-size: 10px;` to
      `font-size: 12px;`

Do NOT change any other styles. Keep scrollbar colors, padding, line-height, and line number styling
as-is. </action> <verify> Run `npm run check` - no new TypeScript errors. Grep for the changes:

- `grep -n "1a1a1a\|border-radius: 12px\|font-size: 12px" src/lib/scss/_markdown.scss` </verify>
  <done> pre.shiki has background-color #1a1a1a, border-radius 12px, and mobile font-size 12px.
  </done> </task>

<task type="auto">
  <name>Task 2: Coordinate border-radius on figure container</name>
  <files>src/lib/components/molecules/CodeBlock.svelte</files>
  <action>
Update the CodeBlock.svelte figure and figcaption styles to use 12px border-radius:

1. Update `figcaption.filename-container` border-radius:
    - Change `border-radius: 8px 8px 0 0;` to `border-radius: 12px 12px 0 0;`

2. Update `.caption-background` border-radius:
    - Change `border-radius: 8px 8px 0 0;` to `border-radius: 12px 12px 0 0;`

3. Add `overflow: hidden;` to the `figure` element to clip content to border-radius:
    - This ensures the header and pre element don't overflow the rounded corners

4. Add `border-radius: 12px;` to the `figure` element (container level):
    - This provides the overall shape

The pre.shiki inside will have matching radius from \_markdown.scss. When header is present, the
figcaption has top corners and pre has bottom corners handled by the existing rule
`figcaption + :global(pre.shiki)` which removes top radius. </action> <verify> Run `npm run check` -
no new errors. Visual check: `npm run dev` and view a blog post with code blocks - corners should be
uniformly rounded at 12px. </verify> <done> Figure container has overflow:hidden and 12px
border-radius. Figcaption corners coordinated at 12px. </done> </task>

<task type="auto">
  <name>Task 3: Verify visual appearance</name>
  <files></files>
  <action>
Run the development server and verify the changes on a blog post with code blocks:

1. Start dev server: `npm run dev`
2. Navigate to a blog post with code blocks (e.g., one of the existing posts)
3. Verify visually:
    - Code blocks have dark (#1a1a1a) background
    - Corners are noticeably more rounded (12px vs old 8px)
    - On mobile viewport (use browser dev tools), code is readable at 12px

4. Run full test suite: `npm run test`
5. Run build: `npm run build` </action> <verify> Build passes with no errors. Tests pass. </verify>
   <done> Container styling complete: dark background, 12px radius, 12px mobile font. </done>
   </task>

</tasks>

<verification>
After all tasks complete:
1. `npm run check` passes
2. `npm run build` passes
3. Code blocks display with consistent 12px rounded corners
4. Background is dark (#1a1a1a) regardless of any theme context
5. Mobile font size is 12px (check in browser dev tools responsive mode)
</verification>

<success_criteria>

- CODE-01: Code blocks have theme-independent dark background (#1a1a1a)
- CODE-02: 12px border-radius on all code block corners
- CODE-07: Mobile font size is 12px (readable on small screens)
- Build passes, no regressions </success_criteria>

<output>
After completion, create `.planning/phases/07-code-blocks/07-01-SUMMARY.md`
</output>
