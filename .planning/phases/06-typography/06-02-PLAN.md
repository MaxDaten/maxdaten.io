---
phase: 06-typography
plan: 02
type: execute
wave: 2
depends_on: [06-01]
files_modified:
    - src/lib/scss/global.scss
    - src/lib/scss/_typography.scss
    - src/lib/scss/_markdown.scss
    - src/routes/[slug]/+page.svelte
autonomous: true

must_haves:
    truths:
        - 'Body text displays with visible breathing room between lines (1.6-1.7 line-height)'
        - 'Headings display with tight line-height (1.1-1.2)'
        - 'Prose text constrains to ~60-80 characters per line'
        - 'Code blocks break out wider than prose column'
        - 'Images break out wider than prose column'
    artifacts:
        - path: 'src/lib/scss/global.scss'
          provides: 'Body line-height using token'
          contains: '--text-body-leading'
        - path: 'src/lib/scss/_typography.scss'
          provides: 'Heading line-heights'
          contains: '--text-heading-leading'
        - path: 'src/lib/scss/_markdown.scss'
          provides: 'Paragraph and list line-heights using tokens'
          contains: '--raw-leading'
        - path: 'src/routes/[slug]/+page.svelte'
          provides: '680px prose width and breakout rules'
          contains: '680px'
    key_links:
        - from: 'src/lib/scss/global.scss'
          to: 'src/lib/scss/_tokens-typography.scss'
          via: 'CSS custom property reference'
          pattern: "var\\(--text-body-leading\\)"
        - from: 'src/lib/scss/_typography.scss'
          to: 'src/lib/scss/_tokens-typography.scss'
          via: 'CSS custom property reference'
          pattern: "var\\(--text-heading-leading\\)"
---

<objective>
Apply line-height tokens and configure prose width with code block breakout

Purpose: Transform reading experience by applying the typography tokens established in Phase 5. Body
text gets more breathing room (1.6-1.7), headings get tighter line-height (1.1-1.2), and prose
constrains to optimal reading width (680px) while code blocks and images break out to ~800px.

Output: Updated SCSS files consuming typography tokens, article page with explicit prose width and
CSS grid breakout rules. </objective>

<execution_context> @./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md </execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-typography/06-CONTEXT.md
@.planning/phases/06-typography/06-RESEARCH.md
@.planning/phases/06-typography/06-01-SUMMARY.md
@src/lib/scss/_tokens-typography.scss
@src/lib/scss/global.scss
@src/lib/scss/_typography.scss
@src/lib/scss/_markdown.scss
@src/routes/[slug]/+page.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Apply body line-height token in global.scss</name>
  <files>src/lib/scss/global.scss</files>
  <action>
    Update body line-height to use the semantic typography token:

    In the `body` ruleset (around line 69-86):
    - Change: `line-height: 1.3;`
    - To: `line-height: var(--text-body-leading);`

    This references `--text-body-leading` which equals `--raw-leading-relaxed` (1.65) from _tokens-typography.scss.

    The value 1.65 is within the target range of 1.6-1.7 specified in TYPO-01.

  </action>
  <verify>DevTools shows body has `line-height: 1.65` (the computed value of the token)</verify>
  <done>Body text displays with 1.65 line-height using the semantic token</done>
</task>

<task type="auto">
  <name>Task 2: Apply heading line-heights in _typography.scss</name>
  <files>src/lib/scss/_typography.scss</files>
  <action>
    Add line-height declarations to heading styles:

    1. After the existing h1/h2/h3/h4/h5 shared ruleset (lines 58-64), update it to include line-height:
       ```scss
       h1,
       h2,
       h3,
       h4,
       h5 {
           font-family: var(--font--default);
           line-height: var(--text-heading-leading);
       }
       ```

    2. For h3 and h4, add slightly looser line-height (1.25 instead of 1.1):
       Add after the shared ruleset:
       ```scss
       h3,
       h4 {
           line-height: var(--raw-leading-snug);
       }
       ```

    Token values from _tokens-typography.scss:
    - `--text-heading-leading` = 1.1 (for h1, h2)
    - `--raw-leading-snug` = 1.25 (for h3, h4, h5)

    Per CONTEXT.md: H1-H2 at 1.1 (tighter), H3-H4 at 1.2 (slightly looser). Using 1.25 is acceptable as "close enough" per RESEARCH.md open questions.

  </action>
  <verify>DevTools shows h1/h2 have line-height ~1.1, h3/h4/h5 have line-height ~1.25</verify>
  <done>Headings display with tight line-heights (h1-h2: 1.1, h3-h5: 1.25)</done>
</task>

<task type="auto">
  <name>Task 3: Update paragraph and list line-heights in _markdown.scss</name>
  <files>src/lib/scss/_markdown.scss</files>
  <action>
    Update line-heights in .content ruleset to use tokens:

    1. Update paragraph line-height (around line 11-13):
       - Change: `line-height: 1.55em;`
       - To: `line-height: var(--text-body-leading);`

    2. Update list line-height (around line 66-75):
       - Change: `line-height: 1.6;`
       - To: `line-height: var(--raw-leading-normal);`

       Token value: `--raw-leading-normal` = 1.5 (slightly tighter than prose, per CONTEXT.md decision for lists: 1.4-1.5)

    3. Add blockquote line-height (inside .content blockquote, around line 57-63):
       Add: `line-height: var(--raw-leading-normal);`

       Per CONTEXT.md: Blockquotes at 1.5 line-height.

  </action>
  <verify>DevTools shows: paragraphs 1.65, lists 1.5, blockquotes 1.5</verify>
  <done>Markdown content uses token-based line-heights throughout</done>
</task>

<task type="auto">
  <name>Task 4: Update prose width and add breakout rules</name>
  <files>src/routes/[slug]/+page.svelte</files>
  <action>
    Update article layout in the style block:

    1. Change prose width from ch-based to explicit pixel value (around line 132):
       - Change: `--main-column-width: 65ch;`
       - To: `--main-column-width: 680px;`

       Per TYPO-03: 680px for 60-80 characters per line. Using explicit pixels instead of ch units ensures consistency across font changes (per RESEARCH.md pitfall #3).

    2. Add breakout rules for code blocks and images after the `.content` grid definition (after line 234):
       Add inside the `.content` ruleset:
       ```scss
       // Breakout elements - wider than prose column
       :global(.code-block),
       :global(pre.shiki),
       :global(.wrap.reveal) {
           grid-column: 1 / -1;
           max-width: 800px;
           width: 100%;
           margin-left: auto;
           margin-right: auto;
       }
       ```

       Per CONTEXT.md: Code blocks and images break out to ~800px (moderate breakout, not edge-to-edge).

  </action>
  <verify>Measure prose column width in DevTools (~680px), measure code block width (~800px or 100% on mobile)</verify>
  <done>Prose constrains to 680px, code blocks and images break out to 800px max</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build` passes
2. DevTools computed values:
   - body line-height: 1.65
   - h1/h2 line-height: 1.1
   - h3/h4/h5 line-height: 1.25
   - p (in .content) line-height: 1.65
   - ul/ol (in .content) line-height: 1.5
   - blockquote line-height: 1.5
3. Article prose column measures ~680px on desktop
4. Code blocks measure ~800px max-width on desktop
5. On mobile (<680px), everything is full-width
6. Visual inspection: Paragraphs have more breathing room, headings are tight
</verification>

<success_criteria>

- TYPO-01 complete: Body text line-height 1.65 (within 1.6-1.7 range)
- TYPO-02 complete: Heading line-height 1.1 for h1-h2, 1.25 for h3+
- TYPO-03 complete: Prose constrains to 680px
- Code blocks and images break out to 800px max
- All line-heights use CSS custom property tokens from Phase 5
- Consistent vertical rhythm throughout article content </success_criteria>

<output>
After completion, create `.planning/phases/06-typography/06-02-SUMMARY.md`
</output>
